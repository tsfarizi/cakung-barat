<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Galeri - Kelurahan Cakung Barat</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>

<!-- Navbar -->
<header class="navbar">
  <div class="container">
    <div class="logo">
      <img src="assets/img/logo.png" alt="Logo">
      <span>Cakung Barat</span>
    </div>

    <nav class="nav-menu">
      <ul>
        <li><a href="index.html">Beranda</a></li>
        <li><a href="profil.html">Profil</a></li>
        <li><a href="pelayanan.html">Pelayanan</a></li>
        <li><a href="informasi.html">Informasi</a></li>
        <li><a href="galeri.html" class="active">Dashboard Galeri</a></li>
        <li><a href="kontak.html">Kontak</a></li>
      </ul>
    </nav>
  </div>
</header>

<!-- Hero -->
<section class="hero">
  <div class="hero-content">
    <h1>Dashboard Galeri</h1>
    <p>Upload foto kegiatan baru untuk ditampilkan di halaman galeri publik.</p>
  </div>
</section>

<!-- Galeri Section -->
<section class="gallery-section">
  <div class="container">
    <h2 class="title-horizontal">Kegiatan Permanen</h2>

    <div class="gallery-container">
      <div class="gallery-item">
        <div class="gallery-img" style="background-image: url('https://images.unsplash.com/photo-1582213782179-e0d53f98f2ca?auto=format&fit=crop&w=800&q=80')"></div>
        <div class="gallery-content">
          <h3>Kerja Bakti RW 05</h3>
          <p>Warga RW 05 membersihkan lingkungan dan menjaga kebersihan area publik.</p>
        </div>
      </div>
      <div class="gallery-item">
        <div class="gallery-img" style="background-image: url('https://images.unsplash.com/photo-1579684385127-1ef15d508118?auto=format&fit=crop&w=800&q=80')"></div>
        <div class="gallery-content">
          <h3>Vaksinasi Massal</h3>
          <p>Program kesehatan masyarakat untuk meningkatkan imun warga.</p>
        </div>
      </div>
      <div class="gallery-item">
        <div class="gallery-img" style="background-image: url('https://images.unsplash.com/photo-1593115057322-e94b77572f20?auto=format&fit=crop&w=800&q=80')"></div>
        <div class="gallery-content">
          <h3>Peringatan HUT RI</h3>
          <p>Acara lomba dan upacara memperingati Hari Kemerdekaan Indonesia.</p>
        </div>
      </div>
    </div>

    <hr style="margin:50px 0; border:1px solid #ccc;">

    <h2 class="title-horizontal">Tambah Galeri Baru</h2>

<div class="content-box">
  <form id="gallery-form" class="gallery-form">
    <div class="form-group">
      <label for="judul" class="form-label">Judul Kegiatan</label>
      <input type="text" id="judul" class="form-input" placeholder="Masukkan judul kegiatan">
    </div>

    <div class="form-group">
      <label for="deskripsi" class="form-label">Deskripsi Kegiatan</label>
      <textarea id="deskripsi" class="form-textarea" rows="4" placeholder="Masukkan deskripsi singkat tentang kegiatan"></textarea>
    </div>

    <div class="form-group">
      <label for="gambar" class="form-label">Upload Gambar</label>
      <div class="file-upload-container">
        <input type="file" id="gambar" class="file-input" accept="image/*" hidden>
        <div class="file-upload-area" id="file-upload-area">
          <i class="fas fa-cloud-upload-alt file-upload-icon"></i>
          <p class="file-upload-text">Klik untuk memilih gambar atau drag & drop di sini</p>
          <p class="file-upload-hint">Format: JPG, PNG, GIF (Maks. 5MB)</p>
        </div>
        <div class="file-preview" id="file-preview"></div>
      </div>
    </div>

    <div class="form-actions">
      <button type="button" id="add-gallery" class="btn btn-primary">
        <i class="fas fa-plus-circle"></i> Tambah Galeri
      </button>
      <button type="reset" class="btn btn-secondary">
        <i class="fas fa-redo"></i> Reset Form
      </button>
    </div>
  </form>
</div>

<style>
/* Form Styles */
.gallery-form {
  max-width: 800px;
  margin: 0 auto;
}

.form-group {
  margin-bottom: 2rem;
}

.form-label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 600;
  color: #333;
  font-size: 1rem;
}

.form-input,
.form-textarea {
  width: 100%;
  padding: 12px 16px;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 1rem;
  transition: all 0.3s ease;
  background-color: #fff;
}

.form-input:focus,
.form-textarea:focus {
  outline: none;
  border-color: #2d7ba5;
  box-shadow: 0 0 0 3px rgba(45, 123, 165, 0.1);
}

.form-textarea {
  resize: vertical;
  min-height: 120px;
  font-family: 'Poppins', sans-serif;
}

/* File Upload Styles */
.file-upload-container {
  margin-top: 0.5rem;
}

.file-upload-area {
  border: 2px dashed #2d7ba5;
  border-radius: 12px;
  padding: 2.5rem;
  text-align: center;
  background-color: #f8fbff;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
}

.file-upload-area:hover {
  background-color: #e8f4ff;
  border-color: #1e5a7d;
}

.file-upload-area.dragover {
  background-color: #d4edff;
  border-color: #1e5a7d;
  transform: scale(1.02);
}

.file-upload-icon {
  font-size: 3rem;
  color: #2d7ba5;
  margin-bottom: 1rem;
}

.file-upload-text {
  font-size: 1.1rem;
  font-weight: 600;
  color: #333;
  margin-bottom: 0.5rem;
}

.file-upload-hint {
  font-size: 0.9rem;
  color: #666;
  margin: 0;
}

.file-preview {
  margin-top: 1.5rem;
  text-align: center;
}

.preview-image {
  max-width: 300px;
  max-height: 200px;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  border: 3px solid #fff;
}

.preview-info {
  margin-top: 0.5rem;
  font-size: 0.9rem;
  color: #666;
}

/* Form Actions */
.form-actions {
  display: flex;
  gap: 1rem;
  justify-content: flex-start;
  margin-top: 2rem;
  padding-top: 1.5rem;
  border-top: 1px solid #e0e0e0;
}

.btn {
  padding: 12px 24px;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.btn-primary {
  background: linear-gradient(135deg, #2d7ba5, #1e5a7d);
  color: white;
}

.btn-primary:hover {
  background: linear-gradient(135deg, #1e5a7d, #154569);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(45, 123, 165, 0.3);
}

.btn-secondary {
  background: #f8f9fa;
  color: #333;
  border: 2px solid #e0e0e0;
}

.btn-secondary:hover {
  background: #e9ecef;
  border-color: #ccc;
}

/* Responsive Design */
@media (max-width: 768px) {
  .form-actions {
    flex-direction: column;
  }
  
  .btn {
    width: 100%;
    justify-content: center;
  }
  
  .file-upload-area {
    padding: 1.5rem;
  }
  
  .file-upload-text {
    font-size: 1rem;
  }
}

/* Loading State */
.btn.loading {
  position: relative;
  color: transparent;
}

.btn.loading::after {
  content: '';
  position: absolute;
  width: 20px;
  height: 20px;
  top: 50%;
  left: 50%;
  margin-left: -10px;
  margin-top: -10px;
  border: 2px solid #ffffff;
  border-radius: 50%;
  border-top-color: transparent;
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>

<script>
// Enhanced JavaScript for better UX
document.addEventListener('DOMContentLoaded', function() {
  const fileInput = document.getElementById('gambar');
  const fileUploadArea = document.getElementById('file-upload-area');
  const filePreview = document.getElementById('file-preview');
  const addGalleryBtn = document.getElementById('add-gallery');
  const form = document.getElementById('gallery-form');

  // Drag and drop functionality
  fileUploadArea.addEventListener('click', () => fileInput.click());
  
  fileUploadArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    fileUploadArea.classList.add('dragover');
  });
  
  fileUploadArea.addEventListener('dragleave', () => {
    fileUploadArea.classList.remove('dragover');
  });
  
  fileUploadArea.addEventListener('drop', (e) => {
    e.preventDefault();
    fileUploadArea.classList.remove('dragover');
    const files = e.dataTransfer.files;
    if (files.length > 0) {
      fileInput.files = files;
      handleFileSelection(files[0]);
    }
  });

  // File input change
  fileInput.addEventListener('change', (e) => {
    if (e.target.files.length > 0) {
      handleFileSelection(e.target.files[0]);
    }
  });

  // Handle file selection and preview
  function handleFileSelection(file) {
    // Validate file type and size
    const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif'];
    const maxSize = 5 * 1024 * 1024; // 5MB
    
    if (!validTypes.includes(file.type)) {
      alert('Format file tidak didukung. Harap upload gambar JPG, PNG, atau GIF.');
      return;
    }
    
    if (file.size > maxSize) {
      alert('Ukuran file terlalu besar. Maksimal 5MB.');
      return;
    }

    // Show preview
    const reader = new FileReader();
    reader.onload = function(e) {
      filePreview.innerHTML = `
        <img src="${e.target.result}" alt="Preview" class="preview-image">
        <div class="preview-info">
          <strong>${file.name}</strong> (${(file.size / 1024 / 1024).toFixed(2)} MB)
        </div>
      `;
    };
    reader.readAsDataURL(file);
  }

  // Enhanced form submission
  addGalleryBtn.addEventListener('click', function() {
    const title = document.getElementById('judul').value.trim();
    const desc = document.getElementById('deskripsi').value.trim();
    const file = fileInput.files[0];

    // Validation
    if (!title) {
      showError('Judul kegiatan harus diisi');
      document.getElementById('judul').focus();
      return;
    }

    if (!desc) {
      showError('Deskripsi kegiatan harus diisi');
      document.getElementById('deskripsi').focus();
      return;
    }

    if (!file) {
      showError('Gambar harus diupload');
      return;
    }

    // Show loading state
    const originalText = addGalleryBtn.innerHTML;
    addGalleryBtn.innerHTML = '<i class="fas fa-spinner"></i> Menyimpan...';
    addGalleryBtn.disabled = true;

    // Process file upload
    const reader = new FileReader();
    reader.onload = function(e) {
      const imgData = e.target.result;
      const galleryData = JSON.parse(localStorage.getItem('galleryData') || '[]');
      
      galleryData.push({ 
        title, 
        desc, 
        img: imgData,
        date: new Date().toISOString()
      });
      
      localStorage.setItem('galleryData', JSON.stringify(galleryData));
      
      // Show success message
      showSuccess('Galeri berhasil ditambahkan!');
      
      // Reset form
      form.reset();
      filePreview.innerHTML = '';
      
      // Re-enable button
      addGalleryBtn.innerHTML = originalText;
      addGalleryBtn.disabled = false;
      
      // Refresh gallery display
      renderGallery();
    };
    
    reader.readAsDataURL(file);
  });

  // Utility functions for notifications
  function showError(message) {
    alert(message); // Bisa diganti dengan notifikasi yang lebih elegan
  }

  function showSuccess(message) {
    alert(message); // Bisa diganti dengan notifikasi yang lebih elegan
  }
});
</script>

    <h3 style="margin-top:40px;">Preview Galeri Tambahan</h3>
    <div class="gallery-container" id="admin-gallery" style="margin-top:20px;"></div>
  </div>
</section>

<!-- Footer -->
<footer>
  <div class="container footer-grid">
    <div>
      <h4>Kelurahan Cakung Barat</h4>
      <p>Jl Tipar Cakung Pool PPD Depo C RT.02/07<br>Kecamatan Cakung, Jakarta Timur 13910</p>
    </div>
    <div>
      <h4>Tautan Terkait</h4>
      <ul>
        <li><a href="https://jakarta.go.id" target="_blank">Portal DKI Jakarta</a></li>
        <li><a href="https://timur.jakarta.go.id/kecamatan/Cakung" target="_blank">Kecamatan Cakung</a></li>
      </ul>
    </div>
    <div>
      <h4>Hubungi Kami</h4>
      <p>Email: cakungbarat.64@gmail.com<br>Telp: (021) 4601748</p>
    </div>
  </div>
  <p class="copyright">Â© 2025 Kelurahan Cakung Barat</p>
</footer>

<!-- Script -->
<script>
function renderGallery() {
  const galleryData = JSON.parse(localStorage.getItem('galleryData') || '[]');
  const container = document.getElementById('admin-gallery');

  if (galleryData.length === 0) {
    container.innerHTML = "<p><em>Belum ada galeri tambahan.</em></p>";
    return;
  }

  container.innerHTML = galleryData.map((item, index) => `
    <div class="gallery-item">
      <div class="gallery-img" style="background-image:url('${item.img}')"></div>
      <div class="gallery-content">
        <h3>${item.title}</h3>
        <p>${item.desc}</p>
        <button class="btn delete-btn" data-index="${index}">
          <i class="fa fa-trash"></i> Hapus
        </button>
      </div>
    </div>
  `).join('');

  // Tambahkan event listener untuk tombol hapus
  document.querySelectorAll('.delete-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const index = this.getAttribute('data-index');
      deleteGallery(index);
    });
  });
}

function deleteGallery(index) {
  const galleryData = JSON.parse(localStorage.getItem('galleryData') || '[]');
  const item = galleryData[index];

  if (confirm(`Yakin ingin menghapus galeri "${item.title}"?`)) {
    galleryData.splice(index, 1);
    localStorage.setItem('galleryData', JSON.stringify(galleryData));
    renderGallery();
  }
}

document.getElementById('add-gallery').addEventListener('click', function() {
  const title = document.getElementById('judul').value.trim();
  const desc = document.getElementById('deskripsi').value.trim();
  const fileInput = document.getElementById('gambar');
  const file = fileInput.files[0];

  if (!title || !desc || !file) {
    alert('Semua kolom wajib diisi dan gambar harus diupload!');
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e) {
    const imgData = e.target.result;
    const galleryData = JSON.parse(localStorage.getItem('galleryData') || '[]');
    galleryData.push({ title, desc, img: imgData });
    localStorage.setItem('galleryData', JSON.stringify(galleryData));
    alert('Galeri berhasil ditambahkan!');
    renderGallery();
    document.getElementById('gallery-form').reset();
  };
  reader.readAsDataURL(file);
});

renderGallery();
</script>

</body>
</html>
